{
    "swagger": "2.0",
    "info": {
        "title": "OpenCT PQBS - api document",
        "description": "beego has a very cool tools to autogenerate documents for your API",
        "version": "1.0.0",
        "termsOfService": "http://",
        "contact": {
            "email": "kkoogqw@hotmail.com"
        },
        "license": {
            "name": "Apache 2.0",
            "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
        }
    },
    "basePath": "/review",
    "paths": {
        "/file/": {
            "post": {
                "tags": [
                    "file"
                ],
                "description": "文件上传, 使用post form格式上传, 会自动解析token获得对应的上传者id",
                "operationId": "FileController.UploadFile",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "formData",
                        "name": "filename",
                        "description": "文件名",
                        "required": true,
                        "type": "file"
                    },
                    {
                        "in": "formData",
                        "name": "description",
                        "description": "文件注释和说明",
                        "type": "string"
                    },
                    {
                        "in": "formData",
                        "name": "tags",
                        "description": "文件标签",
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid file\""
                    }
                }
            }
        },
        "/file/info/{fid}": {
            "get": {
                "tags": [
                    "file"
                ],
                "description": "只获取文件信息, 不执行下载",
                "operationId": "FileController.GetFileInfo",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "path",
                        "name": "fid",
                        "description": "file uuid",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid file uuid\""
                    }
                }
            }
        },
        "/file/search": {
            "post": {
                "tags": [
                    "file"
                ],
                "description": "条件搜素文件, 搜索结果 (待完善)",
                "operationId": "FileController.SearchFiles",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "body",
                        "name": "json",
                        "description": "搜索条件",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/request.SearchFile"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid conditions (parse body failed)\""
                    }
                }
            }
        },
        "/file/{fid}": {
            "get": {
                "tags": [
                    "file"
                ],
                "description": "download a file by file id(根据文件id下载文件)",
                "operationId": "FileController.DownloadFile",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "path",
                        "name": "fid",
                        "description": "file uuid",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid file uuid\""
                    }
                }
            },
            "delete": {
                "tags": [
                    "file"
                ],
                "description": "删除文件上传记录(不在磁盘存储中删除文件)",
                "operationId": "FileController.DeleteFile",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "path",
                        "name": "fid",
                        "description": "the file's uuid you want to delete",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid file id\""
                    }
                }
            }
        },
        "/proj/": {
            "put": {
                "tags": [
                    "proj"
                ],
                "description": "更新项目相关信息",
                "operationId": "ProjectController.UpdateProjectInfo",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "body",
                        "name": "json",
                        "description": "要更新的项目信息数据",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/request.UpdateProjectInfo"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid body\""
                    }
                }
            },
            "post": {
                "tags": [
                    "proj"
                ],
                "description": "创建一个空项目(不创建相关流程和任务)",
                "operationId": "ProjectController.CreateEmptyProject",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "body",
                        "name": "json",
                        "description": "基本的项目信息, 创建人(creator)一项不需要填写,会根据token自动解析填充",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/request.CreateProject"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid project json body(token)\""
                    }
                }
            }
        },
        "/proj/assign": {
            "post": {
                "tags": [
                    "proj"
                ],
                "description": "create a user assignment for a project (创建一个人员分配记录: 项目-用户-角色)",
                "operationId": "ProjectController.MakeOneAssignment",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "body",
                        "name": "json",
                        "description": "assignment information",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/request.MakeOneAssignment"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid token(body)\""
                    }
                }
            },
            "patch": {
                "tags": [
                    "proj"
                ],
                "description": "更改一个角色分配",
                "operationId": "ProjectController.ChangeAssignment",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "body",
                        "name": "json",
                        "description": "new role to change",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/request.ChangeAssignment"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid bodu\""
                    }
                }
            }
        },
        "/proj/assign/confirm/{aid}": {
            "get": {
                "tags": [
                    "proj"
                ],
                "description": "用户端确认角色分配申请",
                "operationId": "ProjectController.ConfirmAssignment",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "path",
                        "name": "aid",
                        "description": "true",
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid uuid\""
                    }
                }
            }
        },
        "/proj/assign/{aid}": {
            "delete": {
                "tags": [
                    "proj"
                ],
                "description": "删除一条角色分配",
                "operationId": "ProjectController.DeleteAssignment",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "path",
                        "name": "aid",
                        "description": "uuid of assignment to delete",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid uuid\""
                    }
                }
            }
        },
        "/proj/assign/{pid}": {
            "get": {
                "tags": [
                    "proj"
                ],
                "description": "获取一个项目的所有人员分配情况",
                "operationId": "ProjectController.GetProjectAssignment",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "path",
                        "name": "pid",
                        "description": "project id",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid project id\""
                    }
                }
            }
        },
        "/proj/basic/{pid}": {
            "get": {
                "tags": [
                    "proj"
                ],
                "description": "获取项目的基本信息数据",
                "operationId": "ProjectController.GetBasicInfo",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "path",
                        "name": "pid",
                        "description": "项目的uuid",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid project id\""
                    }
                }
            }
        },
        "/proj/group": {
            "post": {
                "tags": [
                    "proj"
                ],
                "description": "创建一个项目的人员分配(同时分配多种角色)",
                "operationId": "ProjectController.MakeAssignmentGroup",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "body",
                        "name": "json",
                        "description": "需要每种角色的user id",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/request.MakeAssignmentGroup"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid token(body)\""
                    }
                }
            }
        },
        "/proj/user/{uid}": {
            "get": {
                "tags": [
                    "proj"
                ],
                "description": "获取某一个用户的所有项目参与情况(即参与各个项目的角色分配情况)",
                "operationId": "ProjectController.GetUserAssignment",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "path",
                        "name": "uid",
                        "description": "user id",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid user id\""
                    }
                }
            }
        },
        "/user/": {
            "get": {
                "tags": [
                    "user"
                ],
                "description": "get all Users (已废弃)",
                "operationId": "UserController.GetAll",
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/models.User"
                            }
                        }
                    }
                }
            },
            "put": {
                "tags": [
                    "user"
                ],
                "description": "更新用户信息 (主要提交post时必须所有选项都要填写, 没发生更改的应当填充原来的信息数据)",
                "operationId": "UserController.UpdateUserInfo",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "body",
                        "name": "json",
                        "description": "要更新的用户信息数据",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/request.UserUpdateInfo"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"parse body error\""
                    }
                }
            },
            "post": {
                "tags": [
                    "user"
                ],
                "description": "用户注册部分, 邮箱和手机号不能和已注册用户重复",
                "operationId": "UserController.UserRegister",
                "parameters": [
                    {
                        "in": "body",
                        "name": "json",
                        "description": "要注册的用户信息",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/request.UserRegister"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"parse body failed\""
                    }
                }
            }
        },
        "/user/login": {
            "post": {
                "tags": [
                    "user"
                ],
                "description": "user login: 用户登录(邮箱 \u0026 手机号 二选一即可登录)",
                "operationId": "UserController.UserLogin",
                "parameters": [
                    {
                        "in": "body",
                        "name": "json",
                        "description": "user email / phone \u0026 password",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/request.UserLogin"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"parse body failed\""
                    }
                }
            }
        },
        "/user/logout": {
            "get": {
                "tags": [
                    "user"
                ],
                "description": "user logout: 用户退出, 注销token的有效期",
                "operationId": "UserController.UserLogout",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid ??\""
                    }
                }
            }
        },
        "/user/password": {
            "put": {
                "tags": [
                    "user"
                ],
                "description": "update user's password: 更新用户密码(需要重新认证原密码) todo: 更新完成后退出当前登录 (注销 token)",
                "operationId": "UserController.UpdateUserPassword",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "body",
                        "name": "json",
                        "description": "需要填写旧密码和新密码",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/request.UserUpdatePassword"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid body data\""
                    }
                }
            }
        },
        "/user/{uid}": {
            "get": {
                "tags": [
                    "user"
                ],
                "description": "get a user info (profile): 根据用户id获取用户基本信息 (用户密码不会返回)",
                "operationId": "UserController.GetUser",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token recived at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "path",
                        "name": "uid",
                        "description": "user 的 uuid",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid user id\""
                    }
                }
            },
            "delete": {
                "tags": [
                    "user"
                ],
                "description": "delete a user by user id: 根据id删除用户记录",
                "operationId": "UserController.UserDelete",
                "parameters": [
                    {
                        "in": "header",
                        "name": "token",
                        "description": "user token get at login",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "in": "path",
                        "name": "uid",
                        "description": "user uuid",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "",
                        "schema": {
                            "$ref": "#/definitions/response.Default"
                        }
                    },
                    "400": {
                        "description": "\"invalid user uuid\""
                    }
                }
            }
        }
    },
    "definitions": {
        "1260.0xc00048b590.false": {
            "title": "false",
            "type": "object"
        },
        "field.DefaultField": {
            "title": "DefaultField",
            "type": "object"
        },
        "models.User": {
            "title": "User",
            "type": "object",
            "properties": {
                "password": {
                    "type": "string"
                },
                "profile": {
                    "$ref": "#/definitions/models.UserProfile"
                },
                "salt": {
                    "type": "string"
                },
                "uuid": {
                    "type": "string"
                }
            }
        },
        "models.UserProfile": {
            "title": "UserProfile",
            "type": "object",
            "properties": {
                "age": {
                    "type": "integer",
                    "format": "int64"
                },
                "degree": {
                    "type": "string"
                },
                "email": {
                    "type": "string"
                },
                "employer": {
                    "type": "string"
                },
                "gender": {
                    "type": "boolean"
                },
                "locaion": {
                    "type": "string"
                },
                "major": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "phone": {
                    "type": "string"
                },
                "position": {
                    "type": "string"
                }
            }
        },
        "request.ChangeAssignment": {
            "title": "ChangeAssignment",
            "type": "object",
            "properties": {
                "assignment_id": {
                    "type": "string"
                },
                "new_role": {
                    "type": "integer",
                    "format": "int64"
                },
                "operator": {
                    "type": "string"
                }
            }
        },
        "request.CreateProject": {
            "title": "CreateProject",
            "type": "object",
            "properties": {
                "description": {
                    "type": "string"
                },
                "grade_range": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "name": {
                    "type": "string"
                },
                "requirement": {
                    "type": "string"
                },
                "subjects": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "summary": {
                    "type": "string"
                },
                "target": {
                    "type": "string"
                },
                "user_id": {
                    "type": "string"
                }
            }
        },
        "request.MakeAssignmentGroup": {
            "title": "MakeAssignmentGroup",
            "type": "object",
            "properties": {
                "admin": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "assistant": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "expert": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "operator": {
                    "type": "string"
                },
                "out_experts": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "project_id": {
                    "type": "string"
                },
                "teachers": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            }
        },
        "request.MakeOneAssignment": {
            "title": "MakeOneAssignment",
            "type": "object",
            "properties": {
                "operator": {
                    "type": "string"
                },
                "project_id": {
                    "type": "string"
                },
                "role": {
                    "type": "integer",
                    "format": "int64"
                },
                "user_id": {
                    "type": "string"
                }
            }
        },
        "request.SearchFile": {
            "title": "SearchFile",
            "type": "object",
            "properties": {
                "file_name": {
                    "type": "string"
                },
                "tags": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "type": {
                    "type": "string"
                }
            }
        },
        "request.UpdateProjectInfo": {
            "title": "UpdateProjectInfo",
            "type": "object",
            "properties": {
                "description": {
                    "type": "string"
                },
                "grade_range": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "name": {
                    "type": "string"
                },
                "project_id": {
                    "type": "string"
                },
                "requirement": {
                    "type": "string"
                },
                "subjects": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "summary": {
                    "type": "string"
                },
                "target": {
                    "type": "string"
                }
            }
        },
        "request.UserLogin": {
            "title": "UserLogin",
            "type": "object",
            "properties": {
                "email": {
                    "type": "string"
                },
                "password": {
                    "type": "string"
                },
                "phone": {
                    "type": "string"
                }
            }
        },
        "request.UserRegister": {
            "title": "UserRegister",
            "type": "object",
            "properties": {
                "degree": {
                    "type": "string"
                },
                "email": {
                    "type": "string"
                },
                "employer": {
                    "type": "string"
                },
                "gender": {
                    "type": "boolean"
                },
                "location": {
                    "type": "string"
                },
                "major": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "password": {
                    "type": "string"
                },
                "phone": {
                    "type": "string"
                },
                "position": {
                    "type": "string"
                }
            }
        },
        "request.UserUpdateInfo": {
            "title": "UserUpdateInfo",
            "type": "object",
            "properties": {
                "degree": {
                    "type": "string"
                },
                "email": {
                    "type": "string"
                },
                "employer": {
                    "type": "string"
                },
                "gender": {
                    "type": "boolean"
                },
                "id": {
                    "type": "string"
                },
                "location": {
                    "type": "string"
                },
                "major": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "phone": {
                    "type": "string"
                },
                "position": {
                    "type": "string"
                }
            }
        },
        "request.UserUpdatePassword": {
            "title": "UserUpdatePassword",
            "type": "object",
            "properties": {
                "id": {
                    "type": "string"
                },
                "new_password": {
                    "type": "string"
                },
                "old_password": {
                    "type": "string"
                }
            }
        },
        "response.Default": {
            "title": "Default",
            "type": "object",
            "properties": {
                "data": {
                    "$ref": "#/definitions/1260.0xc00048b590.false"
                },
                "message": {
                    "type": "string"
                },
                "operation_code": {
                    "type": "integer",
                    "format": "int64"
                }
            }
        }
    },
    "tags": [
        {
            "name": "user",
            "description": "Operations about Users\n"
        },
        {
            "name": "file",
            "description": "Operations of files\n"
        }
    ]
}